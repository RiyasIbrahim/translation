# Translation Project

## Serivces
1. Django service serves as Backend
2. React service serves as Frontend

### Django

**It is using the django inbuild DB**

#### Models
##### `Project`
        **Structure:**
            article_title: CharField of max length 150, stores the title of the Wikipedia page
            target_language: CharField of max length 3, stores the targeted language
            project_id: CharField of max length 154 and a primary key, stores the id of the project. Id is of type *target_language + _ + article_title*
            created_on: DateTimeField to store the creation date-time
            created_by: ForeignKey to link with User Model Id
            assigned_to: BigIntegerField stores the id of the user assigned to

##### `Sentence`
        **Structure:**
            project: ForeignKey which maps to Project Model
            sentence_id: BigAutoField, autogenerated Id of the sentence. It is the primary key
            original_sentence: TextField, stores the original sentence taken from the wikipedia
            translated_sentence: TextField, stores the user written translation sentence. It can be blank or null
            created_on: DateTimeField to store the creation date-time

#### Endpoints
##### `/admin/`
    Default endpoint for User Management.

##### `GET /wiki/`
    Endpoint for getting Project objects, according to user permissions
        1. super user can get all the projects.
        2. Users in Manager group can get only the project created by them.
        3. Users in Annotator group can get only the project they were assigned to.
    It is a protected endpoint(Only logged users can access)

##### `POST /wiki/`
    Endpoint for creating a Project. Consumes a body of type Application/Json like shown below:
        {
            article_title: "India",
            target_language: "ta"
        }
    Only superusers or users in Manager group can create projects.
    Other users will get 403 UNAUTHOURIZED
    It is a protected endpoint(Only logged users can access)

##### `POST /wiki/login/`
    Endpoint for Authentication. Uses the django default authorization mechanism. Consumes a body of type Multipart/form-data.
    Once the user is authenticated, it returns a access and refresh token.

##### `POST /wiki/login/refresh/`
    Endpoint of access token refresh. Not used currently. 

##### `GET /wiki/project/<str:project_id>`
    Endpoint for getting a project by it's ID. It takes the project id as path param.
    It return 404 NOT FOUND for the following scenarios:
        1. User is in Manager group, but this project is not created by the user.
        2. User is in Annotator group, but this project is not assigned to the user.
        3. If the project is not exist in the DB.
    We get 403 UNAUTHORIZED for user who are not super user and also not a part of groups Manager or Annotator.
    Other scenarios, User gets the project object with return code 200.
    It is a protected endpoint(Only logged users can access)

##### `PATCH /wiki/project/<str:project_id>`
    Endpoint for patching a project by it's ID. It takes the project id as path param.
    It return 404 NOT FOUND for the following scenarios:
        1. User is in Manager group, but this project is not created by the user.
        2. User is in Annotator group
        3. If the project is not exist in the DB.
    We get 403 UNAUTHORIZED for user who are not super user and also not a part of groups Manager or Annotator.
    Other scenarios, project object get patched with return code 200.
    It is a protected endpoint(Only logged users can access)

##### `GET /wiki/<str:project_id>/sentence`
    Endpoint for getting Sentence objects in a Project. It takes the project id as path param.
    It return 404 NOT FOUND for the following scenarios:
        1. User is in Manager group, but this project is not created by the user.
        2. User is in Annotator group, but this project is not assigned to the user.
        3. If the project is not exist in the DB.
    We get 403 UNAUTHORIZED for user who are not super user and also not a part of groups Manager or Annotator.
    Other scenarios, User gets the sentences with return code 200.
    It is a protected endpoint(Only logged users can access)

##### `POST /wiki/<str:project_id>/sentence`
     Endpoint for creating a Project. Consumes a body of type Application/Json like shown below:
        {
            project: "India_ta",
            original_sentence: "Hi How are you"
        }
        Only superusers or users in Manager group can create sentence.
        Other users will get 403 UNAUTHOURIZED
        It is a protected endpoint(Only logged users can access)

##### `GET /wiki/sentence/<int:sentence_id>`
    Endpoint for getting the sentence with the sentence ID. Internally it get's the project associated with the sentence and check for authorization.
    It return 404 NOT FOUND for the following scenarios:
        1. User is in Manager group, but this project is not created by the user.
        2. User is in Annotator group, but this project is not assigned to the user.
        3. If the project is not exist in the DB.
    We get 403 UNAUTHORIZED for user who are not super user and also not a part of groups Manager or Annotator.
    Other scenarios, User gets the sentence with return code 200.
    It is a protected endpoint(Only logged users can access)

##### `PATCH /wiki/sentence/<int:sentence_id>`
    Endpoint for patching the sentence with sentence ID. Internally it get's the project associated with the sentence and check for authorization.
    It return 404 NOT FOUND for the following scenarios:
        1. User is in Manager group, but this project is not created by the user.
        2. User is in Annotator group, but this project is not assigned to the user.
        3. If the project is not exist in the DB.
    We get 403 UNAUTHORIZED for user who are not super user and also not a part of groups Manager or Annotator.
    Other scenarios, sentence object gets patched with return code 200.
    It is a protected endpoint(Only logged users can access)

##### `GET /wiki/users`
    Endpoint to get the user list and the current user Id. No roles are checked.
    It is a protected endpoint(Only logged users can access)

### React

#### Pages

##### `Login Page`
    Request user the user name and password. Once submitted, It send a request to the Django service for the endpoint (POST /wiki/login/).
    For successfull response, the page gets redirected to the Project List page. It also stores the access and refresh token in the local storage.
    Since, the token is not store in the cookie, clearing the cookies and cache will not log you out. You need to manually signout

##### `Project List`
    As soon the page is opened 2 AJAX calls were made to the following endpoint
    1. GET /wiki/ to get the list of Projects
    2. GET /wiki/user to get the current user and list of all users
    About the Page
    1. Header contains the Application Name and a sign out button, which clear the local storage and redirect the user to login page
    2. If there are no projects available for the user. No project available is shown, with a button to create new project. This button is enable only for superusers and Managers
    3. If there are projects available for the user, A table is displayed with the list of project and their creator and to whom they have been assigned to.
    4. The assignee field in the table changable, where superusers or Manager who created the project can change the assignee. Whenever the assignee is changed, a AJAX call is made to the endpoint (PATCH /wiki/project/<str:project_id>) to patch the object
    5. Clicking the project title will take you to the next page Sentence List Page
    6. Click the button Create New Project, opens up a Modal which asks for the project info such as
        Title, Language, Assignee(Optional)
    7. Clicking Create button, will do AJAX call to the endpoint (POST /wiki/) for project creation]
    8. First project get created, then it gets the sentences using wikipedia api and then using nltp library it tokenize the summary into sentences, and then save the sentence. 
    9. Incase of error while adding the sentence, the project is also deleted.

##### `Sentence List`
    1. As soon the page is opened an AJAX call is made to the endpoint (GET /wiki/<str:project_id>/sentence) to get all the sentences.
    2. Header contains the a back button(When clicked takes us to Project List page), project title and a sign out button, which clear the local storage and redirect the user to login page
    3. If there are no sentences available, it shows a message in the middle that no sentence are there.
    4. Otherwise, you will have the original sentences on the left side and translated one on the left side. While you translate, a drop down is shown for transliterating the words to the targeted language.
    5. When changes are made, A button (Save Changes) is enabled on the Header. By click the button, all the changes are saved by iterating for each changes through a AJAX call to the endpoint (PATCH /wiki/sentence/<int:sentence_id>)

